---
title: "Omictools Visualization"
author: "gahoolee"
date: "Friday, August 28, 2015"
output: html_document
runtime: shiny
---


```{r, echo=FALSE, eval=T}
library(shiny)
library(jsonlite)
library(d3treeR)
library(DT)
load('omictools_tree.RData')

ui <- fluidPage(
  d3tree2Output( 'tree' ),
  textOutput( "clickedinfo", container = p ),
  DT::dataTableOutput('catalog')
)

server <- function( input, output, session ){
  output$tree <- renderD3tree2({
    d3tree2(toJSON(omictools, auto_unbox = T),
            celltext = "name")
  })

  # from https://github.com/rstudio/leaflet/blob/master/inst/examples/shiny.R
  v <- reactiveValues(table = NULL)

  observeEvent(input$tree_click, {
    v$table <- subset(catalog_tree_df, parent.name == input$tree_click$name)
    
    if(nrow(v$table)==0){
      v$table <- subset(software_tree_df, parent.name == input$tree_click$name)
    }
  })

  output$clickedinfo <- renderText(input$tree_click$name)
  output$catalog <- DT::renderDataTable(v$table)
}

shinyApp( ui, server,
          options=list(
            width="100%", height="1024")
          )
```

```{r, echo=FALSE, eval=FALSE}
library(jsonlite)
library(d3treeR)
library(DT)
library(listviewer)
load('omictools_tree.RData')

renderD3tree2({
    d3tree2(toJSON(omictools, auto_unbox = T),
            celltext = "name")
  })

msg<-paste0(ls(), collapse = '\t')
selectInput('variables', 'variables',
            choices=ls(),
            selected=NULL)

v <- reactiveValues(msg = msg,
                    table = NULL,
                    m = list(aa=1))

renderJsonedit({
  jsonedit(get(input$variables))
  })

observeEvent(input$tree_click, {
  v$msg <- input$tree_click$name
  v$table <- subset(software_tree_df, parent.name == input$tree_click$name)
})

renderText(input$tree_click$name)

DT::renderDataTable(v$table)
```
